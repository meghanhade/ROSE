<html>
  <head>
    <link href='http://api.tiles.mapbox.com/mapbox.js/v1.2.0/mapbox.css' rel='stylesheet' />

    <script src='http://api.tiles.mapbox.com/mapbox.js/v1.2.0/mapbox.js'></script>
    <style>
      #map {
        height:500px;
        width: 500px;
      }
    </style>
  </head>
  
  <body>
    <div id='map'></div><script type='text/javascript'>
      var r_text = [
        "Here there's a river that winds on forever",
        "Here there's an island where all things are silent",
        "Here there's a mountain that no man has mounted",
        "Here there's a desert that size can't be measured",
        "Here there's a land that time don't command",
        "Here there are strangers, and all kinds of danger",
        "Here there's an island coast where the only souls you'll see are ghosts",
        "Here there's a place where the treeline breaks into wide open space",
        "Here there's a moonlit lake where a cold wind blows and your bones start to shake",
        "Here there's a winding road in the deep of the night, near the edge of the known",
      ];
    </script>
    
    <script type='text/javascript'>
      
      var map = L.mapbox.map('map', 'm365.map-e3lks16p', {
        gridLayer: {},
        gridControl: {
        sanitizer: function(x) { console.log(x); return x; }
        }
        })
        .setView([44.9, -93], 3);
        
      var marker = L.marker(new L.LatLng(44.9833, -93.2667), {
        icon: L.mapbox.marker.icon({'marker-color': 'CC0033'}),
        draggable: true
        });
        
      function updateMarker() {
        var t = Math.floor(r_text.length*Math.random())
        marker.bindPopup(r_text[t]);
        marker.addTo(map);
      }
      
      updateMarker();
      
      marker.on('dragend',updateMarker);

    </script>
  </body>
</html>
